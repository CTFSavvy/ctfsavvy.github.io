<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>55 - All In One</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>cheat sheet -&gt;
https://github.com/corelight/zeek-cheatsheets/blob/master/Corelight-Zeek-Cheatsheets-3.0.4.pdf
### Setting up zeek</p>
<pre><code>docker pull zeek/zeek:latest       

docker run -v $(pwd):/mnt -i zeek/zeek sh</code></pre>
<h3 id="enumeration">Enumeration</h3>
<pre><code>zeek -C -r Capture.pcap local</code></pre>
<p>![[Pasted image 20231213132310.png]]</p>
<pre><code>cat ssh.log | zeek-cut client | sort -u</code></pre>
<p>![[Pasted image 20231213174443.png]]</p>
<pre><code>cat ssh.log | zeek-cut id.orig_h | sort | uniq -c | sort -n | sort -u </code></pre>
<p>![[Pasted image 20231213175212.png]]</p>
<h3 id="setting-zeek-grep">Setting zeek-grep</h3>
<pre><code>alias zeek-grep=&#39;grep -e &quot;^#&quot; -e&#39;^C</code></pre>
<p>![[Pasted image 20231213175244.png]]</p>
<h3 id="http-logs">HTTP logs</h3>
<pre><code>less -S http.log  | zeek-cut user_agent | sort | uniq -c | sort -n</code></pre>
<p>![[Pasted image 20231213180206.png]]</p>
<p>wget looks phisy.</p>
<pre><code>cat http.log | zeek-grep Wget | zeek-cut id.orig_h id.resp_h uri user_agent</code></pre>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@53ef41d5da39:/mnt#</span> cat http.log <span class="kw">|</span> <span class="ex">zeek-grep</span> Wget <span class="kw">|</span> <span class="ex">zeek-cut</span> id.orig_h id.resp_h uri user_agent172.31.39.46    13.233.179.35   /PKCampaign/Targets/Forela/Ransomware2_server.zip       Wget/1.21.2</span></code></pre></div>
<pre><code>less -S http.log  | zeek-cut user_agent | sort | uniq -c | sort -n</code></pre>
<p>![[Pasted image 20231213180206.png]]</p>
<p>wget looks phisy.</p>
<pre><code>cat http.log | zeek-grep Wget | zeek-cut id.orig_h id.resp_h uri user_agent</code></pre>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@53ef41d5da39:/mnt#</span> cat http.log <span class="kw">|</span> <span class="ex">zeek-grep</span> Wget <span class="kw">|</span> <span class="ex">zeek-cut</span> id.orig_h id.resp_h uri user_agent172.31.39.46    13.233.179.35   /PKCampaign/Targets/Forela/Ransomware2_server.zip       Wget/1.21.2</span></code></pre></div>
<p>http://13.233.179.35/PKCampaign/Targets/Forela/Ransomware2_server.zip</p>
<h3 id="ftp-log">FTP log</h3>
<pre><code>less -S ftp.log </code></pre>
<p>![[Pasted image 20231213182143.png]]</p>
<p>in zeek if we have any field related to <code>password</code> zeek
won’t show it. ![[Pasted image 20231213182251.png]]</p>
<p>Editting
<code>/usr/local/zeek/share/zeek/base/protocols/ftp/main.zeek:</code></p>
<p>deleted the password line which had <code>&lt;hiddedn&gt;</code> term
written in the script and then again i ran</p>
<pre><code>zeek -C -r Capture.pcap local</code></pre>
<p>![[Pasted image 20231213182639.png]]</p>
<p>now we can see the passwords.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@53ef41d5da39:/mnt#</span> cat ftp.log <span class="kw">|</span> <span class="ex">zeek-cut</span> user password <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="at">-c</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>      <span class="ex">6</span> tony.shephard   Summer2023!</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>     <span class="ex">41</span> abdullah.yasin  XhlhGame_90HJLDASxfd<span class="kw">&amp;</span><span class="ex">hoooad</span></span></code></pre></div>
<p>another edit in the ftp/main.zeek to see the wrong passwords used by
attacker</p>
<p>![[Pasted image 20231213190959.png]]</p>
<h3 id="password-spray">Password spray</h3>
<pre><code>cat ftp.log | zeek-cut user password | sort | uniq -c | sort -n</code></pre>
<p>![[Pasted image 20231213191255.png]] not we can see the
<code>password spray</code></p>
<h3 id="attackers-ip">Attackers’ IP</h3>
<pre><code>cat ftp.log | zeek-cut id.orig_h | sort | uniq -c | sort -n   </code></pre>
<p>![[Pasted image 20231213191508.png]]</p>
<pre><code>3.109.209.43
120.78.199.189</code></pre>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@53ef41d5da39:/mnt#</span> grep 120.78.199.189 <span class="pp">*</span>.log <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F:</span> <span class="st">&#39;{print $1}&#39;</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="at">-c</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">932</span> conn.log</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">930</span> ftp.log</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@53ef41d5da39:/mnt#</span> grep 3.109.209.43 <span class="pp">*</span>.log <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F:</span> <span class="st">&#39;{print $1}&#39;</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="at">-c</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">65641</span> conn.log</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>      <span class="ex">3</span> dns.log</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>     <span class="ex">34</span> files.log</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">191</span> ftp.log</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>      <span class="ex">2</span> ssh.log</span></code></pre></div>
<h3 id="ips-of-interest">IP’s of interest</h3>
<p>3.109.209.43 120.78.199.189</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> dns.log <span class="kw">|</span> <span class="ex">zeek-grep</span> 3.109.209.43 <span class="kw">|</span> <span class="ex">zeek-cut</span> id.orig_h id.resp_h query</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">172.31.39.46</span>    172.31.0.2      43.209.109.3.in-addr.arpa</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="ex">172.31.39.46</span>    172.31.0.2      ec2-3-109-209-43.ap-south-1.compute.amazonaws.com</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="ex">172.31.39.46</span>    172.31.0.2      ec2-3-109-209-43.ap-south-1.compute.amazonaws.com</span></code></pre></div>
<p>Q2 -&gt; time when attacker started the attack</p>
<pre><code>cat conn.log | zeek-cut id.orig_h | sort | uniq -c | sort -n
</code></pre>
<p>![[Pasted image 20231213230938.png]] 3.109.209.43 made the most
connection to the target.</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> conn.log <span class="kw">|</span> <span class="ex">zeek-grep</span> 3.109.209.43 <span class="kw">|</span> <span class="ex">zeek-cut</span> ts id.orig_h id.resp_p <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-1</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1679397942.571299</span>       3.109.209.43    22</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span> <span class="at">-d</span> @1679397942.571299</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Tue</span> Mar 21 11:25:42 UTC 2023</span></code></pre></div>
<h3 id="making-changes-to-local.zeek-to-extract-files.">Making changes
to local.zeek to extract files.</h3>
<p><code>/usr/local/zeek/share/zeek/site/local.zeek</code></p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@53ef41d5da39:/usr/local/zeek/share/zeek#</span> find . <span class="kw">|</span> <span class="fu">grep</span> extract</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./base/files/extract</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="ex">./base/files/extract/main.zeek</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="ex">./base/files/extract/__load__.zeek</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="ex">./policy/protocols/http/var-extraction-uri.zeek</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="ex">./policy/protocols/http/var-extraction-cookies.zeek</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="ex">./policy/frameworks/intel/seen/smtp-url-extraction.zeek</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="ex">./policy/frameworks/files/extract-all-files.zeek</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="ex">./policy/tuning/defaults/extracted_file_limits.zeek</span></span></code></pre></div>
<p>added this line to local.zeek ![[Pasted image
20231214003923.png]]</p>
<p>also copied local.zeek to custom.zeek</p>
<pre><code>cp local.zeek custom.zeek</code></pre>
<pre><code>zeek -C -r Capture.pcap custom</code></pre>
<p>![[Pasted image 20231214004205.png]]</p>
<p>now we have folder -&gt; <code>extract_files</code></p>
<pre><code>cat http.log | zeek-grep Wget | less -S</code></pre>
<p>![[Pasted image 20231214004523.png]]</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> extract_files/ <span class="kw">|</span> <span class="fu">grep</span> FM4a5p1MGD3XkvhPU7</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="ex">extract-1679398954.413587-HTTP-FM4a5p1MGD3XkvhPU7</span></span></code></pre></div>
<p>![[Pasted image 20231214004747.png]]</p>
<p>the file was 100M, may thats the reason my unzip failed</p>
<p>but running 7z l on the file i was able to get the ransomeware name
-&gt; <code>gonnacry</code></p>
<pre><code>7z l extract-1679398954.413587-HTTP-FM4a5p1MGD3XkvhPU7</code></pre>
<p>![[Pasted image 20231214005044.png]]</p>
<h3 id="finding-more-file-uids-via-ftp.log">Finding more file uids via
ftp.log</h3>
<pre><code>cat ftp.log  | zeek-grep RETR| zeek-cut command arg fuid</code></pre>
<p>![[Pasted image 20231214005925.png]]</p>
<ol type="1">
<li>.backup -&gt;</li>
</ol>
<div class="sourceCode" id="cb30"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="pp">*</span>FgMmRQ11qkbBo3KqNd<span class="pp">*</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[options]</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>      <span class="ex">UseSyslog</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="ex">[FTP-INTERNAL]</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>      <span class="ex">sequence</span>    = 29999,50234,45087</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>      <span class="ex">seq_timeout</span> = 5</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>      <span class="bu">command</span>     = /sbin/iptables <span class="at">-I</span> INPUT <span class="at">-s</span> %IP% <span class="at">-p</span> tcp <span class="at">--dport</span> 24456 <span class="at">-j</span> ACCEPT</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>      <span class="ex">tcpflags</span>    = syn</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Creds for the other backup server abdullah.yasin:XhlhGame_90HJLDASxfd&amp;hoooad</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<ol start="2" type="1">
<li>fetch.sh</li>
</ol>
<div class="sourceCode" id="cb31"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="pp">*</span>FFyvQZ69UFh3EsEbj<span class="pp">*</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define variables</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="va">DB_HOST</span><span class="op">=</span><span class="st">&quot;3.13.65.234&quot;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="va">DB_PORT</span><span class="op">=</span><span class="st">&quot;3306&quot;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="va">DB_USER</span><span class="op">=</span><span class="st">&quot;tony.shephard&quot;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="va">DB_PASSWORD</span><span class="op">=</span><span class="st">&quot;GameOfthronesRocks7865!&quot;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="va">DB_NAME</span><span class="op">=</span><span class="st">&quot;Internal_Tasks&quot;</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="va">QUERY</span><span class="op">=</span><span class="st">&quot;SELECT * FROM Tasks;&quot;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute query and store result in a variable</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="va">RESULT</span><span class="op">=</span><span class="va">$(</span><span class="ex">mysql</span> <span class="at">-h</span> <span class="va">$DB_HOST</span> <span class="at">-P</span> <span class="va">$DB_PORT</span> <span class="at">-u</span> <span class="va">$DB_USER</span> <span class="at">-p</span><span class="va">$DB_PASSWORD</span> <span class="va">$DB_NAME</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">$QUERY</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$RESULT</span><span class="st">&quot;</span></span></code></pre></div>
<ol start="3" type="1">
<li><p>.archive.sql ![[Pasted image 20231214010831.png]]</p></li>
<li><p>reminder.txt</p></li>
</ol>
<div class="sourceCode" id="cb32"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">cat</span> <span class="pp">*</span>FMuQD02uu7Nf3AdPpi<span class="pp">*</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a> <span class="ex">I</span> am so stupid and dump, i keep forgetting about Forela CEO Happy grunwald visiting Pakistan to start the buisness operations here.I have so many tasks to complete so there are no problems once the Forela Office opens here in Lahore. I am writing this note and placing it on all my remote servers where i login almost daily, just so i dont make a fool of myself and get the urgent tasks done.He is to arrive in my city on 8 march 2023 :<span class="er">))</span><span class="ex">i</span> am finally so happy that we are getting a physical office opening here.</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a> </span></code></pre></div>
<ol start="5" type="1">
<li><p>/etc/passwd ![[Pasted image 20231214012427.png]]</p></li>
<li><p>./Tasks to get Done.docx ![[Pasted image
20231214015725.png]]</p></li>
<li><p>.reminder.</p></li>
</ol>
<div class="sourceCode" id="cb33"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">A</span> reminder to clean up the github repo. Some sensitive data could have been leaked from there</span></code></pre></div>
<h3 id="creds">Creds</h3>
<pre><code>abdullah.yasin:XhlhGame_90HJLDASxfd&amp;hoooad
tony.shephard   Summer2023!
abdullah.yasin  XhlhGame_90HJLDASxfd&amp;hoooad
tony.shephard:GameOfthronesRocks7865!
abdullah:yiobkod0986Y[adij@IKBDS</code></pre>
<pre><code> grep 24456 *.log | less -S</code></pre>
<p>![[Pasted image 20231214011831.png]]</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span> <span class="at">-d</span> @1679396372.918302</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Tue</span> Mar 21 10:59:32 UTC 2023</span></code></pre></div>
<h3 id="port-running-critical-service">Port running critical
service</h3>
<div class="sourceCode" id="cb37"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@53ef41d5da39:/mnt#</span> cat ftp.log  <span class="kw">|</span> <span class="ex">zeek-grep</span> RETR<span class="kw">|</span> <span class="ex">zeek-cut</span> id.resp_p command arg fuid </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="ex">21</span>      RETR    ftp://172.31.39.46/./.backup    FgMmRQ11qkbBo3KqNd</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="ex">21</span>      RETR    ftp://172.31.39.46/./fetch.sh   FFyvQZ69UFh3EsEbj</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="ex">24456</span>   RETR    ftp://172.31.39.46/./.archived.sql      Fjikrz1twh8YRR8H34</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="ex">24456</span>   RETR    ftp://172.31.39.46/./Tasks to get Done.docx     FYD8L514rIoyQiOZZ3</span></code></pre></div>
<p>24456</p>
<h3 id="finding-utc-time-for-above.">finding UTC time for above.</h3>
<p>![[Pasted image 20231214014051.png]]</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span> <span class="at">-d</span> @1679396330.288134</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Tue</span> Mar 21 10:58:50 UTC 2023</span></code></pre></div>
<h3
id="finding-utc-when-attacker-got-access-to-critical-service">finding
UTC when attacker got access to critical service</h3>
<pre><code>cat ftp.log | zeek-grep 3.109.209.43 | grep abdul | less -S</code></pre>
<p>![[Pasted image 20231214014757.png]] login-successful time</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span> <span class="at">-d</span> @1679396401.595583</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Tue</span> Mar 21 11:00:01 UTC 2023</span></code></pre></div>
<h3 id="osint-to-get-ssh-password">OSINT to get ssh password</h3>
<p>clues -&gt; ![[Pasted image 20231214020337.png]] Forela.</p>
<p>and .reminder file -&gt;</p>
<pre><code>A reminder to clean up the github repo. Some sensitive data could have been leaked from there</code></pre>
<p>https://github.com/forela-finance/forela-dev/</p>
<p>In the commit’s i found the password -&gt; ![[Pasted image
20231214020525.png]]</p>
<pre><code>YHUIhnollouhdnoamjndlyvbl398782bapd</code></pre>
<p>![[Pasted image 20231214020601.png]]</p>
</body>
</html>
