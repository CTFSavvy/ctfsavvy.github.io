<!doctype html><html><head><title>55 - All In One</title><base href="../../"><meta id="root-path" root-path="../../"><link rel="icon" sizes="96x96" href="/images/favicon.jpeg"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,minimum-scale=1,maximum-scale=5"><meta charset="UTF-8"><link rel="stylesheet" href="lib/styles/obsidian-styles.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="stylesheet" href="lib/styles/plugin-styles.css"><link rel="stylesheet" href="lib/styles/snippets.css"><link rel="stylesheet" href="lib/styles/generated-styles.css"><style></style><script type="module" src="lib/scripts/graph_view.js"></script><script src="lib/scripts/graph_wasm.js"></script><script src="lib/scripts/tinycolor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lib/scripts/webpage.js"></script><script src="lib/scripts/generated.js"></script></head><body class="theme-dark mod-linux show-inline-title loading"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Obsidian Vault</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">HTB-Sherlock</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">KnockKnock</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">questions</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/18-ssh-password-which-attacker-used-to-access-the-server-and-get-full-access.html"><span class="tree-item-title">18 - SSH password which attacker used to access the server and get full access</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz-full-url-downloaded-ransomware.html"><span class="tree-item-title">zz full url downloaded ransomware</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz-tool-used-to-download-ransomware.html"><span class="tree-item-title">zz tool used to download ransomware</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz-utc-time-when-attacker-started-the-attack-against-server.html"><span class="tree-item-title">zz UTC time when attacker started the attack against server</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz01-open-ports.html"><span class="tree-item-title">zz01 - Open Ports</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz03-mitre-technique-id.html"><span class="tree-item-title">zz03 - MITRE technique ID</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz04-valid-creds-for-initial-access.html"><span class="tree-item-title">zz04 - valid creds for initial access</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz05-attackers'-ip-for-initial-access.html"><span class="tree-item-title">zz05 - Attackers' IP for initial access</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz06-file-which-contained-some-config-data-and-credentials?.html"><span class="tree-item-title">zz06- file which contained some config data and credentials?</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz07-port-running-critical-service.html"><span class="tree-item-title">zz07 - PORT running critical service</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz08-technique-used-to-get-that-critical-service.html"><span class="tree-item-title">zz08 - technique used to get that critical service</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz09-which-ports-were-required-to-interact-with-to-reach-the-critical-service.html"><span class="tree-item-title">zz09 -Which ports were required to interact with to reach the critical service</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz10-whats-the-utc-time-when-interaction-with-previous-question-ports-ended.html"><span class="tree-item-title">zz10 - Whats the UTC time when interaction with previous question ports ended</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz11-what-are-set-of-valid-credentials-for-the-critical-service.html"><span class="tree-item-title">zz11-What are set of valid credentials for the critical service</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz12-at-what-utc-time-attacker-got-access-to-the-critical-server.html"><span class="tree-item-title">zz12-At what UTC Time attacker got access to the critical server</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz13-whats-the-aws-accountid-and-password-for-the-developer-&quot;abdullah&quot;.html"><span class="tree-item-title">zz13-Whats the AWS AccountID and Password for the developer "Abdullah"</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz14-whats-the-deadline-for-hiring-developers-for-forela.html"><span class="tree-item-title">zz14-Whats the deadline for hiring developers for forela</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz15-when-did-ceo-of-forela-was-scheduled-to-arrive-in-pakistan.html"><span class="tree-item-title">zz15-When did CEO of forela was scheduled to arrive in pakistan</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz16-other-user-with-bash-shell.html"><span class="tree-item-title">zz16- Other user with bash shell</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz17-full-path-of-the-file-which-lead-to-access-of-the-server-by-attack.html"><span class="tree-item-title">zz17 - Full path of the file which lead to access of the server by attack</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/questions/zz21-whats-the-ransomware-name.html"><span class="tree-item-title">zz21 - Whats the ransomware name</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/05-enumeration.html"><span class="tree-item-title">05 - Enumeration</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/10-http-logs.html"><span class="tree-item-title">10 - http-logs</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/15-ftp.log.html"><span class="tree-item-title">15 - ftp.log</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/20-ip's-of-interest.html"><span class="tree-item-title">20 - IP's of interest</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/25-dns.log.html"><span class="tree-item-title">25 - DNS.log</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/30-making-changes-to-local.zeek.html"><span class="tree-item-title">30 - making changes to local.zeek</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/35-files-extracted-via-ftp.log.html"><span class="tree-item-title">35 - Files extracted via ftp.log</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/40-creds.html"><span class="tree-item-title">40 - creds</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/45-time-for-interaction-with-critical-service.html"><span class="tree-item-title">45 - time for interaction with critical service</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/50-port-running-critical-service.html"><span class="tree-item-title">50-port running critical service</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/55-all-in-one.html"><span class="tree-item-title">55 - All In One</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/corelight-zeek-cheatsheets-3.0.4.pdf"><span class="tree-item-title">Corelight-Zeek-Cheatsheets-3.0.4</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="htb-sherlock/knockknock/output.html"><span class="tree-item-title">output</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div></div></div><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div></div><div class="document-container show"><div class="markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-properties" tabindex="-1" style="tab-size:4"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="markdown-preview-pusher" style="width:1px;height:.1px;margin-bottom:0"></div><div class="mod-header"><div class="inline-title" data-heading="55 - All In One" id="55_-_All_In_One" style="display:block">55 - All In One</div></div><div><p>cheat sheet -&gt; <a rel="noopener" class="external-link" href="https://github.com/corelight/zeek-cheatsheets/blob/master/Corelight-Zeek-Cheatsheets-3.0.4.pdf" target="_blank">https://github.com/corelight/zeek-cheatsheets/blob/master/Corelight-Zeek-Cheatsheets-3.0.4.pdf</a></p></div><div class="heading-wrapper"><h3 data-heading="Setting up zeek" class="heading" id="Setting_up_zeek"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Setting up zeek<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>docker pull zeek/zeek:latest       

docker run -v $(pwd):/mnt -i zeek/zeek sh
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Enumeration" class="heading" id="Enumeration"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Enumeration<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>zeek -C -r Capture.pcap local
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213132310.png" src="lib/media/pasted-image-20231213132310.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213132310.png" src="lib/media/pasted-image-20231213132310.png"></span></p></div><div><pre><code>cat ssh.log | zeek-cut client | sort -u
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213174443.png" src="htb-sherlock/knockknock/images/pasted-image-20231213174443.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213174443.png" src="htb-sherlock/knockknock/images/pasted-image-20231213174443.png"></span></p></div><div><pre><code>cat ssh.log | zeek-cut id.orig_h | sort | uniq -c | sort -n | sort -u 
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213175212.png" src="htb-sherlock/knockknock/images/pasted-image-20231213175212.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213175212.png" src="htb-sherlock/knockknock/images/pasted-image-20231213175212.png"></span></p></div></div></div><div class="heading-wrapper"><h3 data-heading="Setting zeek-grep" class="heading" id="Setting_zeek-grep"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Setting zeek-grep<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>alias zeek-grep='grep -e "^#" -e'^C
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213175244.png" src="htb-sherlock/knockknock/images/pasted-image-20231213175244.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213175244.png" src="htb-sherlock/knockknock/images/pasted-image-20231213175244.png"></span></p></div></div></div><div class="heading-wrapper"><h3 data-heading="HTTP logs" class="heading" id="HTTP_logs"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>HTTP logs<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>less -S http.log  | zeek-cut user_agent | sort | uniq -c | sort -n
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213180206.png" src="htb-sherlock/knockknock/images/pasted-image-20231213180206.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213180206.png" src="htb-sherlock/knockknock/images/pasted-image-20231213180206.png"></span></p></div><div><p>wget looks phisy.</p></div><div><pre><code>cat http.log | zeek-grep Wget | zeek-cut id.orig_h id.resp_h uri user_agent
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">root@53ef41d5da39:/mnt<span class="token comment"># cat http.log | zeek-grep Wget | zeek-cut id.orig_h id.resp_h uri user_agent172.31.39.46    13.233.179.35   /PKCampaign/Targets/Forela/Ransomware2_server.zip       Wget/1.21.2</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><pre><code>less -S http.log  | zeek-cut user_agent | sort | uniq -c | sort -n
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213180206.png" src="htb-sherlock/knockknock/images/pasted-image-20231213180206.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213180206.png" src="htb-sherlock/knockknock/images/pasted-image-20231213180206.png"></span></p></div><div><p>wget looks phisy.</p></div><div><pre><code>cat http.log | zeek-grep Wget | zeek-cut id.orig_h id.resp_h uri user_agent
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">root@53ef41d5da39:/mnt<span class="token comment"># cat http.log | zeek-grep Wget | zeek-cut id.orig_h id.resp_h uri user_agent172.31.39.46    13.233.179.35   /PKCampaign/Targets/Forela/Ransomware2_server.zip       Wget/1.21.2</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p><a rel="noopener" class="external-link" href="http://13.233.179.35/PKCampaign/Targets/Forela/Ransomware2_server.zip" target="_blank">http://13.233.179.35/PKCampaign/Targets/Forela/Ransomware2_server.zip</a></p></div></div></div><div class="heading-wrapper"><h3 data-heading="FTP log" class="heading" id="FTP_log"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>FTP log<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>less -S ftp.log 
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213182143.png" src="htb-sherlock/knockknock/images/pasted-image-20231213182143.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213182143.png" src="htb-sherlock/knockknock/images/pasted-image-20231213182143.png"></span></p></div><div><p>in zeek if we have any field related to <code>password</code> zeek won't show it.<br><span alt="Pasted image 20231213182251.png" src="htb-sherlock/knockknock/images/pasted-image-20231213182251.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213182251.png" src="htb-sherlock/knockknock/images/pasted-image-20231213182251.png"></span></p></div><div><p>Editting <code>/usr/local/zeek/share/zeek/base/protocols/ftp/main.zeek:</code></p></div><div><p>deleted the password line which had <code>&lt;hiddedn&gt;</code> term written in the script and then again i ran</p></div><div><pre><code>zeek -C -r Capture.pcap local
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213182639.png" src="htb-sherlock/knockknock/images/pasted-image-20231213182639.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213182639.png" src="htb-sherlock/knockknock/images/pasted-image-20231213182639.png"></span></p></div><div><p>now we can see the passwords.</p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">root@53ef41d5da39:/mnt<span class="token comment"># cat ftp.log | zeek-cut user password | sort | uniq -c | sort -n</span>
      <span class="token number">6</span> tony.shephard   Summer2023<span class="token operator">!</span>
     <span class="token number">41</span> abdullah.yasin  XhlhGame_90HJLDASxfd<span class="token operator">&amp;</span>hoooad

</code><button class="copy-code-button">Copy</button></pre></div><div><p>another edit in the ftp/main.zeek to see the wrong passwords used by attacker</p></div><div><p><span alt="Pasted image 20231213190959.png" src="htb-sherlock/knockknock/images/pasted-image-20231213190959.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213190959.png" src="htb-sherlock/knockknock/images/pasted-image-20231213190959.png"></span></p></div></div></div><div class="heading-wrapper"><h3 data-heading="Password spray" class="heading" id="Password_spray"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Password spray<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>cat ftp.log | zeek-cut user password | sort | uniq -c | sort -n
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213191255.png" src="htb-sherlock/knockknock/images/pasted-image-20231213191255.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213191255.png" src="htb-sherlock/knockknock/images/pasted-image-20231213191255.png"></span><br>not we can see the <code>password spray</code></p></div></div></div><div class="heading-wrapper"><h3 data-heading="Attackers' IP" class="heading" id="Attackers'_IP"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Attackers' IP<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>cat ftp.log | zeek-cut id.orig_h | sort | uniq -c | sort -n   
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213191508.png" src="htb-sherlock/knockknock/images/pasted-image-20231213191508.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213191508.png" src="htb-sherlock/knockknock/images/pasted-image-20231213191508.png"></span></p></div><div><pre><code>3.109.209.43
120.78.199.189
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">root@53ef41d5da39:/mnt<span class="token comment"># grep 120.78.199.189 *.log | awk -F: '{print $1}' | sort -n | uniq -c</span>
    <span class="token number">932</span> conn.log
    <span class="token number">930</span> ftp.log

</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">root@53ef41d5da39:/mnt<span class="token comment"># grep 3.109.209.43 *.log | awk -F: '{print $1}' | sort -n | uniq -c</span>
  <span class="token number">65641</span> conn.log
      <span class="token number">3</span> dns.log
     <span class="token number">34</span> files.log
    <span class="token number">191</span> ftp.log
      <span class="token number">2</span> ssh.log

</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="IP's of interest" class="heading" id="IP's_of_interest"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>IP's of interest<div class="heading-after">...</div></h3><div class="heading-children"><div><p>3.109.209.43<br>120.78.199.189</p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token function">cat</span> dns.log <span class="token operator">|</span> zeek-grep <span class="token number">3.109</span>.209.43 <span class="token operator">|</span> zeek-cut id.orig_h id.resp_h query
<span class="token number">172.31</span>.39.46    <span class="token number">172.31</span>.0.2      <span class="token number">43.209</span>.109.3.in-addr.arpa
<span class="token number">172.31</span>.39.46    <span class="token number">172.31</span>.0.2      ec2-3-109-209-43.ap-south-1.compute.amazonaws.com
<span class="token number">172.31</span>.39.46    <span class="token number">172.31</span>.0.2      ec2-3-109-209-43.ap-south-1.compute.amazonaws.com

</code><button class="copy-code-button">Copy</button></pre></div><div><p>Q2 -&gt; time when attacker started the attack</p></div><div><pre><code>cat conn.log | zeek-cut id.orig_h | sort | uniq -c | sort -n

</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231213230938.png" src="htb-sherlock/knockknock/images/pasted-image-20231213230938.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231213230938.png" src="htb-sherlock/knockknock/images/pasted-image-20231213230938.png"></span><br>3.109.209.43 made the most connection to the target.</p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token function">cat</span> conn.log <span class="token operator">|</span> zeek-grep <span class="token number">3.109</span>.209.43 <span class="token operator">|</span> zeek-cut ts id.orig_h id.resp_p <span class="token operator">|</span> <span class="token function">tail</span> -1
<span class="token number">1679397942.571299</span>       <span class="token number">3.109</span>.209.43    <span class="token number">22</span>

<span class="token function">date</span> -d @1679397942.571299
Tue Mar <span class="token number">21</span> <span class="token number">11</span>:25:42 UTC <span class="token number">2023</span>

</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Making changes to local.zeek to extract files." class="heading" id="Making_changes_to_local.zeek_to_extract_files."><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Making changes to local.zeek to extract files.<div class="heading-after">...</div></h3><div class="heading-children"><div><p><code>/usr/local/zeek/share/zeek/site/local.zeek</code></p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">root@53ef41d5da39:/usr/local/zeek/share/zeek<span class="token comment"># find . | grep extract</span>
./base/files/extract
./base/files/extract/main.zeek
./base/files/extract/__load__.zeek
./policy/protocols/http/var-extraction-uri.zeek
./policy/protocols/http/var-extraction-cookies.zeek
./policy/frameworks/intel/seen/smtp-url-extraction.zeek
./policy/frameworks/files/extract-all-files.zeek
./policy/tuning/defaults/extracted_file_limits.zeek

</code><button class="copy-code-button">Copy</button></pre></div><div><p>added this line to local.zeek<br><span alt="Pasted image 20231214003923.png" src="htb-sherlock/knockknock/images/pasted-image-20231214003923.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214003923.png" src="htb-sherlock/knockknock/images/pasted-image-20231214003923.png"></span></p></div><div><p>also copied local.zeek to custom.zeek</p></div><div><pre><code>cp local.zeek custom.zeek
</code><button class="copy-code-button">Copy</button></pre></div><div><pre><code>zeek -C -r Capture.pcap custom
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231214004205.png" src="htb-sherlock/knockknock/images/pasted-image-20231214004205.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214004205.png" src="htb-sherlock/knockknock/images/pasted-image-20231214004205.png"></span></p></div><div><p>now we have folder -&gt; <code>extract_files</code></p></div><div><pre><code>cat http.log | zeek-grep Wget | less -S
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231214004523.png" src="htb-sherlock/knockknock/images/pasted-image-20231214004523.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214004523.png" src="htb-sherlock/knockknock/images/pasted-image-20231214004523.png"></span></p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token function">ls</span> extract_files/ <span class="token operator">|</span> <span class="token function">grep</span> FM4a5p1MGD3XkvhPU7

extract-1679398954.413587-HTTP-FM4a5p1MGD3XkvhPU7

</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231214004747.png" src="htb-sherlock/knockknock/images/pasted-image-20231214004747.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214004747.png" src="htb-sherlock/knockknock/images/pasted-image-20231214004747.png"></span></p></div><div><p>the file was 100M, may thats the reason my unzip failed</p></div><div><p>but running 7z l on the file i was able to get the ransomeware name -&gt;<br><code>gonnacry</code></p></div><div><pre><code>7z l extract-1679398954.413587-HTTP-FM4a5p1MGD3XkvhPU7
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231214005044.png" src="htb-sherlock/knockknock/images/pasted-image-20231214005044.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214005044.png" src="htb-sherlock/knockknock/images/pasted-image-20231214005044.png"></span></p></div></div></div><div class="heading-wrapper"><h3 data-heading="Finding more file uids via ftp.log" class="heading" id="Finding_more_file_uids_via_ftp.log"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Finding more file uids via ftp.log<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>cat ftp.log  | zeek-grep RETR| zeek-cut command arg fuid
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231214005925.png" src="htb-sherlock/knockknock/images/pasted-image-20231214005925.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214005925.png" src="htb-sherlock/knockknock/images/pasted-image-20231214005925.png"></span></p></div><div><ol><li data-line="0">.backup -&gt;</li></ol></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token function">cat</span> *FgMmRQ11qkbBo3KqNd*
<span class="token punctuation">[</span>options<span class="token punctuation">]</span>
      UseSyslog

<span class="token punctuation">[</span>FTP-INTERNAL<span class="token punctuation">]</span>
      sequence    <span class="token operator">=</span> <span class="token number">29999,50234</span>,45087
      seq_timeout <span class="token operator">=</span> <span class="token number">5</span>
      <span class="token builtin class-name">command</span>     <span class="token operator">=</span> /sbin/iptables -I INPUT -s %IP% -p tcp --dport <span class="token number">24456</span> -j ACCEPT
      tcpflags    <span class="token operator">=</span> syn


<span class="token comment"># Creds for the other backup server abdullah.yasin:XhlhGame_90HJLDASxfd&amp;hoooad</span>


</code><button class="copy-code-button">Copy</button></pre></div><div><ol start="2"><li data-line="0">fetch.sh</li></ol></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">cat *FFyvQZ69UFh3EsEbj* 
#!/bin/bash

# Define variables
DB_HOST="3.13.65.234"
DB_PORT="3306"
DB_USER="tony.shephard"
DB_PASSWORD="GameOfthronesRocks7865!"
DB_NAME="Internal_Tasks"
QUERY="SELECT * FROM Tasks;"

# Execute query and store result in a variable
RESULT=$(mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASSWORD $DB_NAME -e "$QUERY")

# Print the result
echo "$RESULT"
</code><button class="copy-code-button">Copy</button></pre></div><div><ol start="3"><li data-line="0"><p>.archive.sql<br><span alt="Pasted image 20231214010831.png" src="htb-sherlock/knockknock/images/pasted-image-20231214010831.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214010831.png" src="htb-sherlock/knockknock/images/pasted-image-20231214010831.png"></span></p></li><li data-line="3"><p>reminder.txt</p></li></ol></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded"> cat *FMuQD02uu7Nf3AdPpi*
 I am so stupid and dump, i keep forgetting about Forela CEO Happy grunwald visiting Pakistan to start the buisness operations here.I have so many tasks to complete so there are no problems once the Forela Office opens here in Lahore. I am writing this note and placing it on all my remote servers where i login almost daily, just so i dont make a fool of myself and get the urgent tasks done.He is to arrive in my city on 8 march 2023 :))i am finally so happy that we are getting a physical office opening here.
 

</code><button class="copy-code-button">Copy</button></pre></div><div><ol start="5"><li data-line="0"><p>/etc/passwd<br><span alt="Pasted image 20231214012427.png" src="htb-sherlock/knockknock/images/pasted-image-20231214012427.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214012427.png" src="htb-sherlock/knockknock/images/pasted-image-20231214012427.png"></span></p></li><li data-line="3"><p>./Tasks to get Done.docx<br><span alt="Pasted image 20231214015725.png" src="htb-sherlock/knockknock/images/pasted-image-20231214015725.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214015725.png" src="htb-sherlock/knockknock/images/pasted-image-20231214015725.png"></span></p></li><li data-line="6"><p>.reminder.</p></li></ol></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">A reminder to clean up the github repo. Some sensitive data could have been leaked from there
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Creds" class="heading" id="Creds"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Creds<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>abdullah.yasin:XhlhGame_90HJLDASxfd&amp;hoooad
tony.shephard   Summer2023!
abdullah.yasin  XhlhGame_90HJLDASxfd&amp;hoooad
tony.shephard:GameOfthronesRocks7865!
abdullah:yiobkod0986Y[adij@IKBDS
</code><button class="copy-code-button">Copy</button></pre></div><div><pre><code> grep 24456 *.log | less -S
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231214011831.png" src="htb-sherlock/knockknock/images/pasted-image-20231214011831.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214011831.png" src="htb-sherlock/knockknock/images/pasted-image-20231214011831.png"></span></p></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">date -d @1679396372.918302
Tue Mar 21 10:59:32 UTC 2023
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Port running critical service" class="heading" id="Port_running_critical_service"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Port running critical service<div class="heading-after">...</div></h3><div class="heading-children"><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">root@53ef41d5da39:/mnt<span class="token comment"># cat ftp.log  | zeek-grep RETR| zeek-cut id.resp_p command arg fuid </span>
<span class="token number">21</span>      RETR    ftp://172.31.39.46/./.backup    FgMmRQ11qkbBo3KqNd
<span class="token number">21</span>      RETR    ftp://172.31.39.46/./fetch.sh   FFyvQZ69UFh3EsEbj
<span class="token number">24456</span>   RETR    ftp://172.31.39.46/./.archived.sql      Fjikrz1twh8YRR8H34
<span class="token number">24456</span>   RETR    ftp://172.31.39.46/./Tasks to get Done.docx     FYD8L514rIoyQiOZZ3

</code><button class="copy-code-button">Copy</button></pre></div><div><p>24456</p></div></div></div><div class="heading-wrapper"><h3 data-heading="finding UTC time for above." class="heading" id="finding_UTC_time_for_above."><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>finding UTC time for above.<div class="heading-after">...</div></h3><div class="heading-children"><div><p><span alt="Pasted image 20231214014051.png" src="htb-sherlock/knockknock/images/pasted-image-20231214014051.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214014051.png" src="htb-sherlock/knockknock/images/pasted-image-20231214014051.png"></span></p></div><div><pre class="language-sh" tabindex="0"><code class="language-sh is-loaded">date -d @1679396330.288134
Tue Mar 21 10:58:50 UTC 2023
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="finding UTC when attacker got access to critical service" class="heading" id="finding_UTC_when_attacker_got_access_to_critical_service"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>finding UTC when attacker got access to critical service<div class="heading-after">...</div></h3><div class="heading-children"><div><pre><code>cat ftp.log | zeek-grep 3.109.209.43 | grep abdul | less -S
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231214014757.png" src="htb-sherlock/knockknock/images/pasted-image-20231214014757.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214014757.png" src="htb-sherlock/knockknock/images/pasted-image-20231214014757.png"></span><br>login-successful time</p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token function">date</span> -d @1679396401.595583
Tue Mar <span class="token number">21</span> <span class="token number">11</span>:00:01 UTC <span class="token number">2023</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="OSINT to get ssh password" class="heading" id="OSINT_to_get_ssh_password"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>OSINT to get ssh password<div class="heading-after">...</div></h3><div class="heading-children"><div><p>clues -&gt;<br><span alt="Pasted image 20231214020337.png" src="htb-sherlock/knockknock/images/pasted-image-20231214020337.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214020337.png" src="htb-sherlock/knockknock/images/pasted-image-20231214020337.png"></span><br>Forela.</p></div><div><p>and .reminder file -&gt;</p></div><div><pre><code>A reminder to clean up the github repo. Some sensitive data could have been leaked from there
</code><button class="copy-code-button">Copy</button></pre></div><div><p><a rel="noopener" class="external-link" href="https://github.com/forela-finance/forela-dev/" target="_blank">https://github.com/forela-finance/forela-dev/</a></p></div><div><p>In the commit's i found the password -&gt;<br><span alt="Pasted image 20231214020525.png" src="htb-sherlock/knockknock/images/pasted-image-20231214020525.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214020525.png" src="htb-sherlock/knockknock/images/pasted-image-20231214020525.png"></span></p></div><div><pre><code>YHUIhnollouhdnoamjndlyvbl398782bapd
</code><button class="copy-code-button">Copy</button></pre></div><div><p><span alt="Pasted image 20231214020601.png" src="htb-sherlock/knockknock/images/pasted-image-20231214020601.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231214020601.png" src="htb-sherlock/knockknock/images/pasted-image-20231214020601.png"></span></p></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder"><div class="graph-view-container"><div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div><canvas id="graph-canvas" width="512px" height="512px"></canvas></div></div></div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#55_-_All_In_One"><span class="tree-item-title"><p>55 - All In One</p></span></a></div><div class="tree-item-children"><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Setting_up_zeek"><span class="tree-item-title"><p>Setting up zeek</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Enumeration"><span class="tree-item-title"><p>Enumeration</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Setting_zeek-grep"><span class="tree-item-title"><p>Setting zeek-grep</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#HTTP_logs"><span class="tree-item-title"><p>HTTP logs</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#FTP_log"><span class="tree-item-title"><p>FTP log</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Password_spray"><span class="tree-item-title"><p>Password spray</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Attackers'_IP"><span class="tree-item-title"><p>Attackers' IP</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#IP's_of_interest"><span class="tree-item-title"><p>IP's of interest</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Making_changes_to_local.zeek_to_extract_files."><span class="tree-item-title"><p>Making changes to local.zeek to extract files.</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Finding_more_file_uids_via_ftp.log"><span class="tree-item-title"><p>Finding more file uids via ftp.log</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Creds"><span class="tree-item-title"><p>Creds</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Port_running_critical_service"><span class="tree-item-title"><p>Port running critical service</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#finding_UTC_time_for_above."><span class="tree-item-title"><p>finding UTC time for above.</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#finding_UTC_when_attacker_got_access_to_critical_service"><span class="tree-item-title"><p>finding UTC when attacker got access to critical service</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#OSINT_to_get_ssh_password"><span class="tree-item-title"><p>OSINT to get ssh password</p></span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div></div></div></body></html>